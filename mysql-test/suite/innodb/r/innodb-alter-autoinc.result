CREATE TABLE t1 (a INT) ENGINE=InnoDB;
INSERT INTO t1 VALUES(347),(33101);
ALTER TABLE t1 ADD id INT AUTO_INCREMENT PRIMARY KEY;
ERROR 23000: Duplicate entry '' for key '*UNKNOWN*'
ALTER TABLE t1 ADD PRIMARY KEY(a);
ALTER TABLE t1 DROP PRIMARY KEY, ADD id INT AUTO_INCREMENT PRIMARY KEY;
ERROR 23000: Duplicate entry '347' for key 'PRIMARY'
ALTER TABLE t1 ADD id INT AUTO_INCREMENT;
ERROR 42000: Incorrect table definition; there can be only one auto column and it must be defined as a key
ALTER TABLE t1 ADD id INT AUTO_INCREMENT, ADD INDEX(a, id);
ERROR 42000: Incorrect table definition; there can be only one auto column and it must be defined as a key
ALTER TABLE t1 ADD id INT AUTO_INCREMENT, ADD INDEX(id, a);
SELECT * FROM t1;
a	id
347	0
33101	0
ALTER TABLE t1 DROP COLUMN id;
ALTER TABLE t1 DROP PRIMARY KEY, ADD id INT AUTO_INCREMENT PRIMARY KEY;
ERROR 23000: Duplicate entry '347' for key 'PRIMARY'
DELETE FROM t1 LIMIT 1;
ALTER TABLE t1 DROP PRIMARY KEY, ADD id INT AUTO_INCREMENT PRIMARY KEY;
SELECT * FROM t1;
a	id
33101	0
INSERT INTO t1 SET a=123;
SELECT * FROM t1;
a	id
123	1
33101	0
DROP TABLE t1;
