call mtr.add_suppression("InnoDB: Resizing redo log");
call mtr.add_suppression("InnoDB: Starting to delete and rewrite log files");
call mtr.add_suppression("InnoDB: New log files created");
call mtr.add_suppression("InnoDB: The log sequence numbers [0-9]+ and [0-9]+ in ibdata files do not match the log sequence number [0-9]+ in the ib_logfiles");
CREATE TABLE t1(a INT PRIMARY KEY) ENGINE=InnoDB;
SET DEBUG='+d,crash_commit_before';
INSERT INTO t1 VALUES (42);
ERROR HY000: Lost connection to MySQL server during query
SELECT * FROM t1;
a
INSERT INTO t1 VALUES (42);
SET DEBUG='+d,crash_commit_before';
DELETE FROM t1;
ERROR HY000: Lost connection to MySQL server during query
SELECT * FROM t1;
a
42
INSERT INTO t1 VALUES (123);
SET DEBUG='+d,crash_commit_before';
DELETE FROM t1;
ERROR HY000: Lost connection to MySQL server during query
--innodb-force-recovery-crash=1
auto.cnf
ib_logfile0
ib_logfile1
ib_logfile2
ibdata1
master-bin.index
mtr
mysql
performance_schema
test
--innodb-force-recovery-crash=2
auto.cnf
ib_logfile0
ib_logfile1
ib_logfile2
ibdata1
master-bin.index
mtr
mysql
performance_schema
test
--innodb-force-recovery-crash=3
auto.cnf
ib_logfile0
ib_logfile1
ib_logfile2
ibdata1
master-bin.index
mtr
mysql
performance_schema
test
--innodb-force-recovery-crash=4
auto.cnf
ib_logfile0
ib_logfile1
ib_logfile2
ibdata1
master-bin.index
mtr
mysql
performance_schema
test
--innodb-force-recovery-crash=5
auto.cnf
ib_logfile0
ib_logfile1
ib_logfile2
ibdata1
master-bin.index
mtr
mysql
performance_schema
test
--innodb-force-recovery-crash=6
auto.cnf
ib_logfile1
ib_logfile2
ibdata1
master-bin.index
mtr
mysql
performance_schema
test
--innodb-force-recovery-crash=7
auto.cnf
ibdata1
master-bin.index
mtr
mysql
performance_schema
test
--innodb-force-recovery-crash=8
auto.cnf
ib_logfile1
ib_logfile101
ibdata1
master-bin.index
mtr
mysql
performance_schema
test
--innodb-force-recovery-crash=9
auto.cnf
ib_logfile1
ib_logfile101
ibdata1
master-bin.index
mtr
mysql
performance_schema
test
--innodb-force-recovery-crash=10
auto.cnf
ib_logfile0
ib_logfile1
ibdata1
master-bin.index
mtr
mysql
performance_schema
test
SELECT * FROM t1;
a
42
123
DROP TABLE t1;
