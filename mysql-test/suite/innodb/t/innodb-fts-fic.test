# This is the basic function tests for innodb FTS

-- source include/have_innodb.inc

# Create FTS table
CREATE TABLE articles (
	FTS_DOC_ID BIGINT UNSIGNED AUTO_INCREMENT NOT NULL PRIMARY KEY,
	title VARCHAR(200),
	body TEXT
	) ENGINE=InnoDB;

create unique index FTS_DOC_ID_INDEX on articles(FTS_DOC_ID);

# Insert six rows
INSERT INTO articles (title,body) VALUES
	('MySQL Tutorial','DBMS stands for DataBase ...')  ,
	('How To Use MySQL Well','After you went through a ...'),
	('Optimizing MySQL','In this tutorial we will show ...'),
	('1001 MySQL Tricks','1. Never run mysqld as root. 2. ...'),
	('MySQL vs. YourSQL','In the following database comparison ...'),
	('MySQL Security','When configured properly, MySQL ...');

# Create the FTS index
CREATE FULLTEXT INDEX idx on articles (title, body);

# "the" is in the default stopword, it would not be selected
SELECT * FROM articles WHERE MATCH (title, body)
        AGAINST ('Tutorial' IN NATURAL LANGUAGE MODE);


SELECT COUNT(*) FROM articles
        WHERE MATCH (title, body)
        AGAINST ('database' IN NATURAL LANGUAGE MODE);

SELECT * FROM articles
     WHERE MATCH (title, body)
     AGAINST ('Tutorial' IN NATURAL LANGUAGE MODE);


SELECT COUNT(IF(MATCH (title, body)
        AGAINST ('database' IN NATURAL LANGUAGE MODE), 1, NULL))
        AS count FROM articles;

# Boolean search
# Select rows contain "MySQL" but not "YourSQL"
SELECT * FROM articles WHERE MATCH (title,body)
        AGAINST ('+MySQL -YourSQL' IN BOOLEAN MODE);

# Select rows contain at least one of the two words
SELECT * FROM articles WHERE MATCH (title,body)
        AGAINST ('DBMS Security' IN BOOLEAN MODE);

# Select rows contain both "MySQL" and "YourSQL"
SELECT * FROM articles WHERE MATCH (title,body)
        AGAINST ('+MySQL +YourSQL' IN BOOLEAN MODE);

drop table articles;
