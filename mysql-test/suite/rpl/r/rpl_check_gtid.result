include/master-slave.inc
[connection master]
call mtr.add_suppression("Recovery from master pos .*");
call mtr.add_suppression("Error in Log_event::read_log_event()");
call mtr.add_suppression("Failed to read information on Previous GTids.");
CREATE TABLE t1(id INTEGER) ENGINE= Innodb;
include/rpl_reset.inc
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
include/rpl_check_gtid.inc
include/rpl_check_gtid.inc
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
FLUSH LOGS;
FLUSH LOGS;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
include/rpl_check_gtid.inc
include/rpl_check_gtid.inc
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
FLUSH LOGS;
FLUSH LOGS;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
include/rpl_check_gtid.inc
include/rpl_check_gtid.inc
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
FLUSH LOGS;
FLUSH LOGS;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
include/rpl_check_gtid.inc
include/rpl_check_gtid.inc
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
FLUSH LOGS;
FLUSH LOGS;
include/rpl_reset.inc
SET GLOBAL debug="d,rotate_slave_debug_group";
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
FLUSH LOGS;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
FLUSH LOGS;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
FLUSH LOGS;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
FLUSH LOGS;
SET GLOBAL debug="";
include/rpl_reset.inc
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
include/rpl_check_gtid.inc
include/stop_slave.inc
include/rpl_restart_server.inc [server_number=2]
include/start_slave.inc
FLUSH LOGS;
FLUSH LOGS;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
include/rpl_check_gtid.inc
include/stop_slave.inc
include/rpl_restart_server.inc [server_number=2]
include/start_slave.inc
FLUSH LOGS;
FLUSH LOGS;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
include/rpl_check_gtid.inc
include/stop_slave.inc
include/rpl_restart_server.inc [server_number=2]
include/start_slave.inc
FLUSH LOGS;
FLUSH LOGS;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
include/rpl_check_gtid.inc
include/stop_slave.inc
include/rpl_restart_server.inc [server_number=2]
include/start_slave.inc
FLUSH LOGS;
FLUSH LOGS;
include/rpl_reset.inc
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
include/rpl_check_gtid.inc
include/rpl_check_gtid.inc
include/stop_slave.inc
include/rpl_restart_server.inc [server_number=1]
include/start_slave.inc
FLUSH LOGS;
FLUSH LOGS;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
include/rpl_check_gtid.inc
include/rpl_check_gtid.inc
include/stop_slave.inc
include/rpl_restart_server.inc [server_number=1]
include/start_slave.inc
FLUSH LOGS;
FLUSH LOGS;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
include/rpl_check_gtid.inc
include/rpl_check_gtid.inc
include/stop_slave.inc
include/rpl_restart_server.inc [server_number=1]
include/start_slave.inc
FLUSH LOGS;
FLUSH LOGS;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
include/rpl_check_gtid.inc
include/rpl_check_gtid.inc
include/stop_slave.inc
include/rpl_restart_server.inc [server_number=1]
include/start_slave.inc
FLUSH LOGS;
FLUSH LOGS;
include/stop_slave.inc
RESET SLAVE;
RESET MASTER;
include/start_slave.inc
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
FLUSH LOGS;
FLUSH LOGS;
include/stop_slave.inc
RESET SLAVE;
RESET MASTER;
include/start_slave.inc
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
FLUSH LOGS;
FLUSH LOGS;
include/stop_slave.inc
RESET SLAVE;
RESET MASTER;
include/start_slave.inc
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
FLUSH LOGS;
FLUSH LOGS;
include/stop_slave.inc
RESET SLAVE;
RESET MASTER;
include/start_slave.inc
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
FLUSH LOGS;
FLUSH LOGS;
include/stop_slave.inc
RESET SLAVE;
RESET MASTER;
RESET MASTER;
CHANGE MASTER TO MASTER_AUTO_POSITION= 1, MASTER_LOG_FILE= 'master-bin.000001', MASTER_LOG_POS= 4;
ERROR HY000: Parameters MASTER_LOG_FILE, MASTER_LOG_POS, RELAY_LOG_FILE and RELAY_LOG_POS cannot be set when MASTER_AUTO_POSITION is active.
include/start_slave.inc
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
include/stop_slave.inc
CHANGE MASTER TO MASTER_HOST= 'SLAVE_MASTER_HOST', MASTER_AUTO_POSITION= 1;
include/start_slave.inc
FLUSH LOGS;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
include/stop_slave.inc
CHANGE MASTER TO MASTER_HOST= 'SLAVE_MASTER_HOST', MASTER_AUTO_POSITION= 1;
include/start_slave.inc
FLUSH LOGS;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
include/stop_slave.inc
CHANGE MASTER TO MASTER_HOST= 'SLAVE_MASTER_HOST', MASTER_AUTO_POSITION= 1;
include/start_slave.inc
FLUSH LOGS;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
include/stop_slave.inc
CHANGE MASTER TO MASTER_HOST= 'SLAVE_MASTER_HOST', MASTER_AUTO_POSITION= 1;
include/start_slave.inc
FLUSH LOGS;
include/stop_slave.inc
RESET SLAVE;
RESET MASTER;
RESET MASTER;
CHANGE MASTER TO MASTER_HOST= 'SLAVE_MASTER_HOST', MASTER_AUTO_POSITION= 1;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
START SLAVE UNTIL SQL_BEFORE_GTIDS= "MASTER_UUID:1";
include/wait_for_slave_sql_to_stop.inc
include/stop_slave.inc
include/rpl_check_gtid.inc
FLUSH LOGS;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
START SLAVE UNTIL SQL_BEFORE_GTIDS= "MASTER_UUID:3";
include/wait_for_slave_sql_to_stop.inc
include/stop_slave.inc
include/rpl_check_gtid.inc
FLUSH LOGS;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
START SLAVE UNTIL SQL_BEFORE_GTIDS= "MASTER_UUID:5";
include/wait_for_slave_sql_to_stop.inc
include/stop_slave.inc
include/rpl_check_gtid.inc
FLUSH LOGS;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
START SLAVE UNTIL SQL_BEFORE_GTIDS= "MASTER_UUID:7";
include/wait_for_slave_sql_to_stop.inc
include/stop_slave.inc
include/rpl_check_gtid.inc
FLUSH LOGS;
include/stop_slave.inc
Warnings:
Note	1255	Slave already has been stopped
RESET MASTER;
RESET SLAVE;
CHANGE MASTER TO MASTER_HOST= '127.0.0.1', MASTER_AUTO_POSITION= 0;
RESET MASTER;
include/start_slave.inc
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
include/rpl_check_gtid.inc
include/stop_slave.inc
include/rpl_restart_server.inc [server_number=2 parameters: --relay-log-recovery=1 --debug=d,debug_skip_create_gtid_set]
include/rpl_restart_server.inc [server_number=2 parameters: --relay-log-recovery=1]
include/start_slave.inc
FLUSH LOGS;
FLUSH LOGS;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
include/rpl_check_gtid.inc
include/stop_slave.inc
include/rpl_restart_server.inc [server_number=2 parameters: --relay-log-recovery=1 --debug=d,debug_skip_create_gtid_set]
include/rpl_restart_server.inc [server_number=2 parameters: --relay-log-recovery=1]
include/start_slave.inc
FLUSH LOGS;
FLUSH LOGS;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
include/rpl_check_gtid.inc
include/stop_slave.inc
include/rpl_restart_server.inc [server_number=2 parameters: --relay-log-recovery=1 --debug=d,debug_skip_create_gtid_set]
include/rpl_restart_server.inc [server_number=2 parameters: --relay-log-recovery=1]
include/start_slave.inc
FLUSH LOGS;
FLUSH LOGS;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
include/rpl_check_gtid.inc
include/stop_slave.inc
include/rpl_restart_server.inc [server_number=2 parameters: --relay-log-recovery=1 --debug=d,debug_skip_create_gtid_set]
include/rpl_restart_server.inc [server_number=2 parameters: --relay-log-recovery=1]
include/start_slave.inc
FLUSH LOGS;
FLUSH LOGS;
include/rpl_reset.inc
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
include/rpl_check_gtid.inc
include/stop_slave.inc
include/rpl_restart_server.inc [server_number=2 parameters: --relay-log-recovery=1 --debug=d,debug_error_create_gtid_set]
include/rpl_restart_server.inc [server_number=2 parameters: --relay-log-recovery=1]
include/start_slave.inc
FLUSH LOGS;
FLUSH LOGS;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
include/rpl_check_gtid.inc
include/stop_slave.inc
include/rpl_restart_server.inc [server_number=2 parameters: --relay-log-recovery=1 --debug=d,debug_error_create_gtid_set]
include/rpl_restart_server.inc [server_number=2 parameters: --relay-log-recovery=1]
include/start_slave.inc
FLUSH LOGS;
FLUSH LOGS;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
include/rpl_check_gtid.inc
include/stop_slave.inc
include/rpl_restart_server.inc [server_number=2 parameters: --relay-log-recovery=1 --debug=d,debug_error_create_gtid_set]
include/rpl_restart_server.inc [server_number=2 parameters: --relay-log-recovery=1]
include/start_slave.inc
FLUSH LOGS;
FLUSH LOGS;
BEGIN;
INSERT INTO t1 VALUES(1);
INSERT INTO t1 VALUES(2);
COMMIT;
include/rpl_check_gtid.inc
include/rpl_check_gtid.inc
include/stop_slave.inc
include/rpl_restart_server.inc [server_number=2 parameters: --relay-log-recovery=1 --debug=d,debug_error_create_gtid_set]
include/rpl_restart_server.inc [server_number=2 parameters: --relay-log-recovery=1]
include/start_slave.inc
FLUSH LOGS;
FLUSH LOGS;
include/rpl_reset.inc
DROP TABLE t1;
include/rpl_end.inc
