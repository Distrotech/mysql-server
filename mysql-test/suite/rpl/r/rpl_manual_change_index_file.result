include/master-slave.inc
[connection master]
FLUSH LOGS;
CREATE TABLE t1(c1 INT);
FLUSH LOGS;
call mtr.add_suppression('Got fatal error 1236 from master when reading data from binary log: .*could not find next log');
include/wait_for_slave_io_error.inc [errno=1236]
Last_IO_Error = 'Got fatal error 1236 from master when reading data from binary log: 'could not find next log''
CREATE TABLE t2(c1 INT);
FLUSH LOGS;
CREATE TABLE t3(c1 INT);
FLUSH LOGS;
CREATE TABLE t4(c1 INT);
START SLAVE IO_THREAD;
include/wait_for_slave_io_to_start.inc
SHOW TABLES;
Tables_in_test
t1
t2
t3
t4
DROP TABLE t1, t2, t3, t4;

# BUG#21437 server_errno=29 error message flood mysqld error log
# --------------------------------------------------------------------------
# This test verifies if the ER_MASTER_FATAL_ERROR_READING_BINLOG which
# insteads of EE_FILENOTFOUND error is sent to slave, so that the slave
# I/O thread stops immediately.
include/rpl_reset.inc
call mtr.add_suppression("Got fatal error 1236 from master when reading data from binary log:");
CREATE TABLE t1(c1 int);
DROP TABLE t1;
FLUSH LOGS;
CREATE TABLE t2(c1 int);
DROP TABLE t2;
include/stop_slave.inc
CHANGE MASTER TO master_host='127.0.0.1', master_log_file='master-bin.000001';
START SLAVE IO_THREAD;
include/wait_for_slave_io_error.inc [errno=1236]
Last_IO_Error = 'Got fatal error 1236 from master when reading data from binary log: 'Could not open log file''
CHANGE MASTER TO master_host='127.0.0.1', master_log_file='master-bin.000002';
include/start_slave.inc
include/rpl_end.inc
