!include include/default_ndbd.cnf

[cluster_config.1]
# NoOfReplicas refers to NDBD nodes/nodegroup
NoOfReplicas=                  2
ndbd=,
ndb_mgmd=
# 3 MySQLDS attached to Cluster 1
mysqld=,,                   



[cluster_config.slave]
# NoOfReplicas refers to NDBD nodes/nodegroup
NoOfReplicas=                  2
ndbd=,
ndb_mgmd=
# 3 MySQLDs attached to Cluster 2
mysqld=,,



[mysqld]
open-files-limit=           1024
local-infile
character-set-server=      latin1
connect-timeout=            60
log-bin-trust-function-creators=1
key_buffer_size=            1M
sort_buffer=                256K
max_heap_table_size=        1M
loose-innodb_data_file_path=      ibdata1:10M:autoextend
slave-net-timeout=120
ndbcluster
ndb-wait-setup=60


[mysqld.1.1]
server-id= 1
log-bin= master-bin
binlog_format=row



[mysqld.2.1]
server-id= 2
# Note no binary log



[mysqld.3.1]
server-id= 3
log-bin= master-bin
binlog_format=row



[mysqld.1.slave]
# Note no binlog on this slave
server-id= 4
init-rpl-role= slave
skip-slave-start
loose-skip-innodb
slave-load-tmpdir= ../../../tmp
ndb_connectstring= @mysql_cluster.slave.ndb_connectstring



[mysqld.2.slave]
# Note binlog on this slave, but not logging slave updates
server-id= 5
init-rpl-role= slave
skip-slave-start
loose-skip-innodb
slave-load-tmpdir= ../../../tmp
ndb_connectstring= @mysql_cluster.slave.ndb_connectstring
log-bin= slave-master-bin
binlog_format=row



[mysqld.3.slave]
# Note binlog on this slave, with slave updates logged
server-id= 6
init-rpl-role= slave
skip-slave-start
loose-skip-innodb
slave-load-tmpdir= ../../../tmp
ndb_connectstring= @mysql_cluster.slave.ndb_connectstring
log-bin= slave-master-bin
binlog_format=row
log-slave-updates



[ENV]
MASTER_MYPORT= @mysqld.1.1.port
MASTER_MYPORT1= @mysqld.2.1.port
MASTER_MYSOCK1= @mysqld.2.1.socket
MASTER_MYPORT2= @mysqld.3.1.port
MASTER_MYSOCK2= @mysqld.3.1.socket
SLAVE_MYPORT= @mysqld.1.slave.port
SLAVE_MYSOCK= @mysqld.1.slave.socket
SLAVE_MYPORT1= @mysqld.2.slave.port
SLAVE_MYSOCK1= @mysqld.2.slave.socket
SLAVE_MYPORT2= @mysqld.3.slave.port
SLAVE_MYSOCK2= @mysqld.3.slave.socket


NDB_CONNECTSTRING= @mysql_cluster.1.ndb_connectstring
NDB_CONNECTSTRING_SLAVE= @mysql_cluster.slave.ndb_connectstring
NDB_BACKUP_DIR= @cluster_config.ndbd.1.1.BackupDataDir
