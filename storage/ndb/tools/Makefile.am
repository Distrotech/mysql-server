# Copyright (c) 2004, 2010, Oracle and/or its affiliates. All rights reserved.
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; version 2 of the License.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301  USA

EXTRA_DIST = CMakeLists.txt ndbinfo.sql

BUILT_SOURCES = ndbinfo.sql

noinst_PROGRAMS = 	ndbinfo_sql
dist_bin_SCRIPTS =	ndb_size.pl ndb_error_reporter
dist_pkgdata_DATA = ndbinfo.sql

ndbtools_PROGRAMS = \
  ndb_test_platform \
  ndb_waiter \
  ndb_drop_table \
  ndb_delete_all \
  ndb_desc \
  ndb_drop_index \
  ndb_show_tables \
  ndb_select_all \
  ndb_select_count \
  ndb_restore ndb_config

tools_common_sources = ../test/src/NDBT_ReturnCodes.cpp \
                       ../test/src/NDBT_Table.cpp \
                       ../test/src/NDBT_Output.cpp

ndb_test_platform_SOURCES = ndb_test_platform.cpp
ndb_waiter_SOURCES = waiter.cpp $(tools_common_sources)
ndb_delete_all_SOURCES = delete_all.cpp $(tools_common_sources)
ndb_desc_SOURCES = desc.cpp $(tools_common_sources)
ndb_drop_index_SOURCES = drop_index.cpp $(tools_common_sources)
ndb_drop_table_SOURCES = drop_tab.cpp $(tools_common_sources)
ndb_show_tables_SOURCES = listTables.cpp $(tools_common_sources)
ndb_select_all_SOURCES = select_all.cpp \
                         ../test/src/NDBT_ResultRow.cpp \
                         $(tools_common_sources)
ndb_select_count_SOURCES = select_count.cpp $(tools_common_sources)
ndb_restore_SOURCES = restore/restore_main.cpp \
                      restore/consumer.cpp \
                      restore/consumer_restore.cpp \
                      restore/consumer_printer.cpp \
                      restore/Restore.cpp \
                      ../test/src/NDBT_ResultRow.cpp $(tools_common_sources)

ndb_config_SOURCES = ndb_config.cpp \
	../src/mgmsrv/Config.cpp \
	../src/mgmsrv/ConfigInfo.cpp \
	../src/mgmsrv/InitConfigFileParser.cpp

ndb_config_CXXFLAGS = -I$(top_srcdir)/storage/ndb/src/mgmapi \
                      -I$(top_srcdir)/storage/ndb/src/mgmsrv \
                      -I$(top_srcdir)/storage/ndb/include/mgmcommon

ndb_restore_LDADD = $(top_builddir)/storage/ndb/src/common/util/libndbazio.la \
                    $(LDADD)


ndbinfo_sql_SOURCES = ndbinfo_sql.cpp \
	../src/mgmsrv/Config.cpp \
	../src/mgmsrv/InitConfigFileParser.cpp

ndbinfo_sql_CXXFLAGS = -I$(top_srcdir)/storage/ndb/src/mgmapi

# Build ndbinfo.sql by executing ndbinfo_sql
ndbinfo.sql: $(ndbinfo_sql_SOURCES)
	$(MAKE) $(AM_MAKEFLAGS) ndbinfo_sql$(EXEEXT)
	./ndbinfo_sql$(EXEEXT) > $@-t
	$(MV) $@-t $@

include $(top_srcdir)/storage/ndb/config/common.mk.am
include $(top_srcdir)/storage/ndb/config/type_ndbapitools.mk.am

ndb_test_platform_LDFLAGS = @ndb_bin_am_ldflags@
ndb_waiter_LDFLAGS = @ndb_bin_am_ldflags@
ndb_drop_table_LDFLAGS = @ndb_bin_am_ldflags@
ndb_delete_all_LDFLAGS = @ndb_bin_am_ldflags@
ndb_desc_LDFLAGS = @ndb_bin_am_ldflags@
ndb_drop_index_LDFLAGS = @ndb_bin_am_ldflags@
ndb_show_tables_LDFLAGS = @ndb_bin_am_ldflags@
ndb_select_all_LDFLAGS = @ndb_bin_am_ldflags@
ndb_select_count_LDFLAGS = @ndb_bin_am_ldflags@
ndb_restore_LDFLAGS = @ndb_bin_am_ldflags@
ndb_config_LDFLAGS = @ndb_bin_am_ldflags@
ndbinfo_sql_LDFLAGS = @ndb_bin_am_ldflags@

